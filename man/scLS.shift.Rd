% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scLS.shift.R
\name{scLS.shift}
\alias{scLS.shift}
\title{Perform dual Lomb–Scargle and compute distance between power spectra
for separate group1 and group2 Seurat objects}
\usage{
scLS.shift(
  group1.object,
  group2.object,
  time.col1,
  time.col2,
  features = NULL,
  assay = "RNA",
  slot = "data",
  center = FALSE,
  window.func = NULL,
  f.min = 0.001,
  f.max = 2,
  n.bins = 500,
  dist.method = c("euclidean", "canberra", "manhattan", "maximum", "minkowski", "binary",
    "cosine"),
  n.perm = 100,
  n.cores = 1,
  seed = 8,
  ls.normalization = c("none", "standard", "psd", "model", "log")
)
}
\arguments{
\item{group1.object}{A Seurat object for the group1 group, with pseudotime in metadata
and expression in an assay.}

\item{group2.object}{A Seurat object for the group2 group, with pseudotime in metadata
and expression in an assay.}

\item{time.col1}{Character. Metadata column name in \code{group1.object} containing
pseudotime values for group1.}

\item{time.col2}{Character. Metadata column name in \code{group2.object} containing
pseudotime values for group2.}

\item{features}{Optional. Vector of feature (gene) names to analyze. If \code{NULL}
(default), the intersection of \code{Seurat::VariableFeatures(group1.object)} and
\code{Seurat::VariableFeatures(group2.object)} is used, further intersected with
genes present in both expression matrices.}

\item{assay}{Character. Assay name to extract expression data from for both
objects. Default: \code{"RNA"}.}

\item{slot}{Character. Slot in assay to pull data from for both objects.
Default: \code{"data"}.}

\item{center}{Logical; if \code{TRUE} subtract the mean after windowing (for each
group separately). Default: \code{FALSE}.}

\item{window.func}{Character, function, or \code{NULL}; name of window function in
the \pkg{signal} package (e.g., \code{"hanning"}), or a custom function taking \code{n}
and returning a length-\code{n} vector, or \code{NULL} for no windowing.
Default: \code{NULL}.}

\item{f.min}{Numeric; minimum frequency. Default: \code{0.001}.}

\item{f.max}{Numeric; maximum frequency. Default: \code{2.0}.}

\item{n.bins}{Integer; number of frequency bins. Default: \code{500}.}

\item{dist.method}{Character; distance method. One of
\code{"canberra"}, \code{"euclidean"}, \code{"manhattan"},
\code{"maximum"}, \code{"minkowski"}, \code{"binary"}, \code{"cosine"}.
Values other than \code{"cosine"} are passed to \code{stats::dist()}.
The special value \code{"cosine"} computes \eqn{1 -} cosine similarity.
Default: \code{"canberra"}.}

\item{n.perm}{Integer; number of permutations for the null distribution
(group-label permutation across group1 and group2). Default: \code{100}.}

\item{n.cores}{Integer; number of cores for parallel execution across
features (uses \code{parallel::mclapply}). Default: \code{1}.}

\item{seed}{Integer or \code{NULL}; random seed for reproducibility of permutations
(both R and NumPy). Default: \code{8}.}

\item{ls.normalization}{Character. Normalization mode passed to
\code{astropy.timeseries.LombScargle$power()}. One of
\code{"none"}, \code{"standard"}, \code{"psd"}, \code{"model"}, \code{"log"}.
If \code{"none"} (default), the Astropy side uses \code{"psd"}, which does not
divide by the variance and therefore preserves amplitude differences.}
}
\value{
A tibble with columns:
  \describe{
    \item{gene}{Feature name analyzed.}
    \item{distance}{Observed distance between the two power spectra
      (group1 vs group2).}
    \item{p}{Gaussian-based p-value from the fitted null distribution
      (NA if computation fails).}
  }
}
\description{
This function assumes that group1 and group2 cells are stored in two separate Seurat
objects (group1.object and group2.object). Each object has its own pseudotime column
in metadata. For each feature (gene), Lomb–Scargle periodograms are computed
separately for group1 and group2 along their respective pseudotime axes, and a
distance between the two power spectra is calculated. A null distribution of
distances is obtained by permuting group labels across group1 and group2 cells,
and a Gaussian-based p-value is reported.
}
